<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>hdpgmm.model Module &mdash; pytorch-hdpgmm 0.0.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="hdpgmm.parameters Module" href="hdpgmm.parameters.html" />
    <link rel="prev" title="hdpgmm.math Module" href="hdpgmm.math.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> pytorch-hdpgmm
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="hdpgmm.data.html"><code class="docutils literal notranslate"><span class="pre">hdpgmm.data</span></code> Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="hdpgmm.math.html"><code class="docutils literal notranslate"><span class="pre">hdpgmm.math</span></code> Module</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">hdpgmm.model</span></code> Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#hdpgmm.model.HDPGMM"><code class="docutils literal notranslate"><span class="pre">HDPGMM</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hdpgmm.model.HDPGMM.max_components_corpus"><code class="docutils literal notranslate"><span class="pre">HDPGMM.max_components_corpus</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hdpgmm.model.HDPGMM.max_components_document"><code class="docutils literal notranslate"><span class="pre">HDPGMM.max_components_document</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hdpgmm.model.HDPGMM.variational_params"><code class="docutils literal notranslate"><span class="pre">HDPGMM.variational_params</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hdpgmm.model.HDPGMM.hyper_params"><code class="docutils literal notranslate"><span class="pre">HDPGMM.hyper_params</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hdpgmm.model.HDPGMM.training_monitors"><code class="docutils literal notranslate"><span class="pre">HDPGMM.training_monitors</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hdpgmm.model.HDPGMM.learning_hyperparams"><code class="docutils literal notranslate"><span class="pre">HDPGMM.learning_hyperparams</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hdpgmm.model.HDPGMM.whiten_params"><code class="docutils literal notranslate"><span class="pre">HDPGMM.whiten_params</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hdpgmm.model.HDPGMM.save"><code class="docutils literal notranslate"><span class="pre">HDPGMM.save()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hdpgmm.model.HDPGMM.load"><code class="docutils literal notranslate"><span class="pre">HDPGMM.load()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#hdpgmm.model.lnB"><code class="docutils literal notranslate"><span class="pre">lnB()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#hdpgmm.model.compute_ln_p_phi_x"><code class="docutils literal notranslate"><span class="pre">compute_ln_p_phi_x()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#hdpgmm.model.compute_corpus_stick"><code class="docutils literal notranslate"><span class="pre">compute_corpus_stick()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#hdpgmm.model.compute_document_stick"><code class="docutils literal notranslate"><span class="pre">compute_document_stick()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#hdpgmm.model.compute_normalwishart_probs"><code class="docutils literal notranslate"><span class="pre">compute_normalwishart_probs()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#hdpgmm.model.e_step"><code class="docutils literal notranslate"><span class="pre">e_step()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#hdpgmm.model.m_step"><code class="docutils literal notranslate"><span class="pre">m_step()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#hdpgmm.model.update_parameters"><code class="docutils literal notranslate"><span class="pre">update_parameters()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#hdpgmm.model.init_params"><code class="docutils literal notranslate"><span class="pre">init_params()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#hdpgmm.model.init_temp_vars"><code class="docutils literal notranslate"><span class="pre">init_temp_vars()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#hdpgmm.model.reinit_ss"><code class="docutils literal notranslate"><span class="pre">reinit_ss()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#hdpgmm.model.package_model"><code class="docutils literal notranslate"><span class="pre">package_model()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#hdpgmm.model.infer_documents"><code class="docutils literal notranslate"><span class="pre">infer_documents()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#hdpgmm.model.save_state"><code class="docutils literal notranslate"><span class="pre">save_state()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#hdpgmm.model.load_model"><code class="docutils literal notranslate"><span class="pre">load_model()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#hdpgmm.model.variational_inference"><code class="docutils literal notranslate"><span class="pre">variational_inference()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hdpgmm.parameters.html"><code class="docutils literal notranslate"><span class="pre">hdpgmm.parameters</span></code> Module</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pytorch-hdpgmm</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active"><code class="docutils literal notranslate"><span class="pre">hdpgmm.model</span></code> Module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/hdpgmm.model.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-hdpgmm.model">
<span id="hdpgmm-model-module"></span><h1><code class="docutils literal notranslate"><span class="pre">hdpgmm.model</span></code> Module<a class="headerlink" href="#module-hdpgmm.model" title="Permalink to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="hdpgmm.model.HDPGMM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hdpgmm.model.</span></span><span class="sig-name descname"><span class="pre">HDPGMM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_components_corpus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_components_document</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variational_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="hdpgmm.parameters.html#hdpgmm.parameters.NormalWishartParameters" title="hdpgmm.parameters.NormalWishartParameters"><span class="pre">hdpgmm.parameters.NormalWishartParameters</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="hdpgmm.parameters.html#hdpgmm.parameters.DPParameters" title="hdpgmm.parameters.DPParameters"><span class="pre">hdpgmm.parameters.DPParameters</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="hdpgmm.parameters.html#hdpgmm.parameters.GammaParameters" title="hdpgmm.parameters.GammaParameters"><span class="pre">hdpgmm.parameters.GammaParameters</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="hdpgmm.parameters.html#hdpgmm.parameters.GammaParameters" title="hdpgmm.parameters.GammaParameters"><span class="pre">hdpgmm.parameters.GammaParameters</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="hdpgmm.parameters.html#hdpgmm.parameters.GammaParameters" title="hdpgmm.parameters.GammaParameters"><span class="pre">hdpgmm.parameters.GammaParameters</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyper_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="hdpgmm.parameters.html#hdpgmm.parameters.NormalWishartParameters" title="hdpgmm.parameters.NormalWishartParameters"><span class="pre">hdpgmm.parameters.NormalWishartParameters</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="hdpgmm.parameters.html#hdpgmm.parameters.GammaParameters" title="hdpgmm.parameters.GammaParameters"><span class="pre">hdpgmm.parameters.GammaParameters</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="hdpgmm.parameters.html#hdpgmm.parameters.GammaParameters" title="hdpgmm.parameters.GammaParameters"><span class="pre">hdpgmm.parameters.GammaParameters</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_monitors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_hyperparams</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">whiten_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy._typing._array_like._SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.dtype</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy._typing._nested_sequence._NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy._typing._array_like._SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.dtype</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">complex</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy._typing._nested_sequence._NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">complex</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hdpgmm.model.HDPGMM" title="Permalink to this definition"></a></dt>
<dd><p>dataclass contains the model parameters</p>
<p>it contains all the (variational) parameters and hyper-parameters</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="hdpgmm.model.HDPGMM.max_components_corpus">
<span class="sig-name descname"><span class="pre">max_components_corpus</span></span><a class="headerlink" href="#hdpgmm.model.HDPGMM.max_components_corpus" title="Permalink to this definition"></a></dt>
<dd><p>the maximum number of corpus-level, global components</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hdpgmm.model.HDPGMM.max_components_document">
<span class="sig-name descname"><span class="pre">max_components_document</span></span><a class="headerlink" href="#hdpgmm.model.HDPGMM.max_components_document" title="Permalink to this definition"></a></dt>
<dd><p>the maximum number of document-level components</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hdpgmm.model.HDPGMM.variational_params">
<span class="sig-name descname"><span class="pre">variational_params</span></span><a class="headerlink" href="#hdpgmm.model.HDPGMM.variational_params" title="Permalink to this definition"></a></dt>
<dd><p>tuple of lists of parameters contains variational parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple[list[<a class="reference internal" href="hdpgmm.parameters.html#hdpgmm.parameters.NormalWishartParameters" title="hdpgmm.parameters.NormalWishartParameters">hdpgmm.parameters.NormalWishartParameters</a>], <a class="reference internal" href="hdpgmm.parameters.html#hdpgmm.parameters.DPParameters" title="hdpgmm.parameters.DPParameters">hdpgmm.parameters.DPParameters</a>, <a class="reference internal" href="hdpgmm.parameters.html#hdpgmm.parameters.GammaParameters" title="hdpgmm.parameters.GammaParameters">hdpgmm.parameters.GammaParameters</a>, <em>Union</em>[<a class="reference internal" href="hdpgmm.parameters.html#hdpgmm.parameters.GammaParameters" title="hdpgmm.parameters.GammaParameters">hdpgmm.parameters.GammaParameters</a>, list[<a class="reference internal" href="hdpgmm.parameters.html#hdpgmm.parameters.GammaParameters" title="hdpgmm.parameters.GammaParameters">hdpgmm.parameters.GammaParameters</a>]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hdpgmm.model.HDPGMM.hyper_params">
<span class="sig-name descname"><span class="pre">hyper_params</span></span><a class="headerlink" href="#hdpgmm.model.HDPGMM.hyper_params" title="Permalink to this definition"></a></dt>
<dd><p>tuple of paramters contains hyper parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple[<a class="reference internal" href="hdpgmm.parameters.html#hdpgmm.parameters.NormalWishartParameters" title="hdpgmm.parameters.NormalWishartParameters">hdpgmm.parameters.NormalWishartParameters</a>, <a class="reference internal" href="hdpgmm.parameters.html#hdpgmm.parameters.GammaParameters" title="hdpgmm.parameters.GammaParameters">hdpgmm.parameters.GammaParameters</a>, <a class="reference internal" href="hdpgmm.parameters.html#hdpgmm.parameters.GammaParameters" title="hdpgmm.parameters.GammaParameters">hdpgmm.parameters.GammaParameters</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hdpgmm.model.HDPGMM.training_monitors">
<span class="sig-name descname"><span class="pre">training_monitors</span></span><a class="headerlink" href="#hdpgmm.model.HDPGMM.training_monitors" title="Permalink to this definition"></a></dt>
<dd><p>dictionary contains the training monitoring measures (i.e., training lowerbound)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict[str, list[float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hdpgmm.model.HDPGMM.learning_hyperparams">
<span class="sig-name descname"><span class="pre">learning_hyperparams</span></span><a class="headerlink" href="#hdpgmm.model.HDPGMM.learning_hyperparams" title="Permalink to this definition"></a></dt>
<dd><p>inference hyper-parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict[str, object]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hdpgmm.model.HDPGMM.whiten_params">
<span class="sig-name descname"><span class="pre">whiten_params</span></span><a class="headerlink" href="#hdpgmm.model.HDPGMM.whiten_params" title="Permalink to this definition"></a></dt>
<dd><p>statistics needed for the whitening process</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[dict[str, <em>Union</em>[numpy._typing._array_like._SupportsArray[numpy.dtype], numpy._typing._nested_sequence._NestedSequence[numpy._typing._array_like._SupportsArray[numpy.dtype]], bool, int, float, complex, str, bytes, numpy._typing._nested_sequence._NestedSequence[<em>Union</em>[bool, int, float, complex, str, bytes]]]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hdpgmm.model.HDPGMM.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Path</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#hdpgmm.model.HDPGMM.save" title="Permalink to this definition"></a></dt>
<dd><p>save parameters to the disk
:param path: filename that is used to save parameters to disk</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hdpgmm.model.HDPGMM.load">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Path</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#hdpgmm.model.HDPGMM" title="hdpgmm.model.HDPGMM"><span class="pre">HDPGMM</span></a></span></span><a class="headerlink" href="#hdpgmm.model.HDPGMM.load" title="Permalink to this definition"></a></dt>
<dd><p>load saved paraeters to the memory
:param path: filename of the checkpoint</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>an instance of HDPGMM storing the parameter checkpoint.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hdpgmm.model.lnB">
<span class="sig-prename descclassname"><span class="pre">hdpgmm.model.</span></span><span class="sig-name descname"><span class="pre">lnB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logdet_W</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#hdpgmm.model.lnB" title="Permalink to this definition"></a></dt>
<dd><p>compute <span class="math notranslate nohighlight">\(log B(x)\)</span> from Bishop PRML B.79</p>
<div class="math notranslate nohighlight">
\[B(W, \nu) = |W|^{\frac{-\nu}{2}} \Big( 2^{\frac{\nu D}{2}} \pi^{\frac{D(D-1)}{4}} \prod_{i=1}^{D} \Gamma \big( \frac{\nu + 1 - i}{2} \big) \Big)^{-1}\]</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hdpgmm.model.compute_ln_p_phi_x">
<span class="sig-prename descclassname"><span class="pre">hdpgmm.model.</span></span><span class="sig-name descname"><span class="pre">compute_ln_p_phi_x</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BoolTensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W_chol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W_logdet</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W_isposdef</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BoolTensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#hdpgmm.model.compute_ln_p_phi_x" title="Permalink to this definition"></a></dt>
<dd><p>compute <span class="math notranslate nohighlight">\(log p(x|\phi)\)</span></p>
<p>here we compute the variational likelihood of observation given
latent variables of this iteration.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hdpgmm.model.compute_corpus_stick">
<span class="sig-prename descclassname"><span class="pre">hdpgmm.model.</span></span><span class="sig-name descname"><span class="pre">compute_corpus_stick</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_components_corpus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#hdpgmm.model.compute_corpus_stick" title="Permalink to this definition"></a></dt>
<dd><p>compute corpus-level stick proportions</p>
<p>variational corpus-level stick proportions are computed.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hdpgmm.model.compute_document_stick">
<span class="sig-prename descclassname"><span class="pre">hdpgmm.model.</span></span><span class="sig-name descname"><span class="pre">compute_document_stick</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_components_document</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#hdpgmm.model.compute_document_stick" title="Permalink to this definition"></a></dt>
<dd><p>compute document-level stick proportions</p>
<p>variational document-level stick proportions are computed.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hdpgmm.model.compute_normalwishart_probs">
<span class="sig-prename descclassname"><span class="pre">hdpgmm.model.</span></span><span class="sig-name descname"><span class="pre">compute_normalwishart_probs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W_chol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W_logdet</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W0_inv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#hdpgmm.model.compute_normalwishart_probs" title="Permalink to this definition"></a></dt>
<dd><p>compute variational Normal-Wishart probability</p>
<p>compute variational expectation of Normal-Wishart probability
(see Eq 10.74 from (Bishop 2006))</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hdpgmm.model.e_step">
<span class="sig-prename descclassname"><span class="pre">hdpgmm.model.</span></span><span class="sig-name descname"><span class="pre">e_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LongTensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BoolTensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Eq_eta_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp_vars</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corpus_stick</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">share_alpha0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_step_tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_max_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_ratio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_responsibility</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.1920928955078125e-07</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#hdpgmm.model.e_step" title="Permalink to this definition"></a></dt>
<dd><p>compute expectation step (of variational inference)</p>
<p>this step iteratively infer the latent variables such as document-level sticks
and variational selector parameter <span class="math notranslate nohighlight">\(\varphi\)</span> and <span class="math notranslate nohighlight">\(\zeta\)</span>.</p>
<p>the internal loop for the iterative update terminates when the improvement
of the mini-batch likelihood converges up to the small constant (threshold) set.</p>
<p>Once the inner loop is terminated, cumulator variables for further computing
sufficient statistics are updated.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hdpgmm.model.m_step">
<span class="sig-prename descclassname"><span class="pre">hdpgmm.model.</span></span><span class="sig-name descname"><span class="pre">m_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_total_docs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corpus_stick</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_reg_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.1920928955078125e-07</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hdpgmm.model.m_step" title="Permalink to this definition"></a></dt>
<dd><p>compute M-Step of variational inference</p>
<p>using the “local” updates of latent variables for given mini-batch,
the “global” variables are updated including corpus-level
Gaussian-Wishart parameters and corpus-level sticks</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hdpgmm.model.update_parameters">
<span class="sig-prename descclassname"><span class="pre">hdpgmm.model.</span></span><span class="sig-name descname"><span class="pre">update_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cur_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_update</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corpus_level_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">set</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{'C',</span> <span class="pre">'beta',</span> <span class="pre">'m',</span> <span class="pre">'nu',</span> <span class="pre">'u',</span> <span class="pre">'v',</span> <span class="pre">'w2',</span> <span class="pre">'y'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hdpgmm.model.update_parameters" title="Permalink to this definition"></a></dt>
<dd><p>update parameters from the current local optima</p>
<p>from the optimal parameter for a random mini-batch, global parameters
are updated up to the “update/mixing proportion” decaying over
the number of iterations (which is controlled by <span class="math notranslate nohighlight">\(\kappa\)</span> and <span class="math notranslate nohighlight">\(\tau_{0}\)</span>).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hdpgmm.model.init_params">
<span class="sig-prename descclassname"><span class="pre">hdpgmm.model.</span></span><span class="sig-name descname"><span class="pre">init_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_components_corpus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_components_documents</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataLoader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_uniform_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warm_start_with</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#hdpgmm.model.HDPGMM" title="hdpgmm.model.HDPGMM"><span class="pre">HDPGMM</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#hdpgmm.model.init_params" title="Permalink to this definition"></a></dt>
<dd><p>initialize parameters</p>
<p>helper (wrapper) function that calls the parameter initialization</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hdpgmm.model.init_temp_vars">
<span class="sig-prename descclassname"><span class="pre">hdpgmm.model.</span></span><span class="sig-name descname"><span class="pre">init_temp_vars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_components_corpus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_components_document</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BoolTensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#hdpgmm.model.init_temp_vars" title="Permalink to this definition"></a></dt>
<dd><p>initialize the temporary variables</p>
<p>initialize &amp; allocate the temporary variables
mostly including latent variables (i.e., zeta / varphi)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hdpgmm.model.reinit_ss">
<span class="sig-prename descclassname"><span class="pre">hdpgmm.model.</span></span><span class="sig-name descname"><span class="pre">reinit_ss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#hdpgmm.model.reinit_ss" title="Permalink to this definition"></a></dt>
<dd><p>reset sufficient statistics containers</p>
<p>reset the values to the null value (0.)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hdpgmm.model.package_model">
<span class="sig-prename descclassname"><span class="pre">hdpgmm.model.</span></span><span class="sig-name descname"><span class="pre">package_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_components_corpus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_components_document</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_hyperparams</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#hdpgmm.model.HDPGMM" title="hdpgmm.model.HDPGMM"><span class="pre">HDPGMM</span></a></span></span><a class="headerlink" href="#hdpgmm.model.package_model" title="Permalink to this definition"></a></dt>
<dd><p>package model to parameter objects</p>
<p>re-format the parameter values into the <cite>parameter</cite> objects</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hdpgmm.model.infer_documents">
<span class="sig-prename descclassname"><span class="pre">hdpgmm.model.</span></span><span class="sig-name descname"><span class="pre">infer_documents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="hdpgmm.data.html#hdpgmm.data.HDFMultiVarSeqDataset" title="hdpgmm.data.HDFMultiVarSeqDataset"><span class="pre">HDFMultiVarSeqDataset</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#hdpgmm.model.HDPGMM" title="hdpgmm.model.HDPGMM"><span class="pre">HDPGMM</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_max_inner_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_step_tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_len</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2147483647</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.1920928955078125e-07</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#hdpgmm.model.infer_documents" title="Permalink to this definition"></a></dt>
<dd><p>infer latent variables for new inputs (documents)</p>
<p>compute latent variables for new samples (documents). It is useful for represent
the document into a vector which is handy for many downstream information processes.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hdpgmm.model.save_state">
<span class="sig-prename descclassname"><span class="pre">hdpgmm.model.</span></span><span class="sig-name descname"><span class="pre">save_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_components_corpus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_components_document</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_hyperparams</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">it</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hdpgmm.model.save_state" title="Permalink to this definition"></a></dt>
<dd><p>saving packaged state (parameters) to the disk</p>
<p>saving the parameters into the disk (using binary pickle)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hdpgmm.model.load_model">
<span class="sig-prename descclassname"><span class="pre">hdpgmm.model.</span></span><span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Path</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#hdpgmm.model.HDPGMM" title="hdpgmm.model.HDPGMM"><span class="pre">HDPGMM</span></a></span></span><a class="headerlink" href="#hdpgmm.model.load_model" title="Permalink to this definition"></a></dt>
<dd><p>load saved state</p>
<p>load saved state (binary pickle) to the memory</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hdpgmm.model.variational_inference">
<span class="sig-prename descclassname"><span class="pre">hdpgmm.model.</span></span><span class="sig-name descname"><span class="pre">variational_inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_components_corpus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_components_document</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_update</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">W0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_max_inner_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_step_tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_noise_ratio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_uniform_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">share_alpha0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_parallel_num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warm_start_with</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#hdpgmm.model.HDPGMM" title="hdpgmm.model.HDPGMM"><span class="pre">HDPGMM</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_len</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_every</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'hdp_gmm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.1920928955078125e-07</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#hdpgmm.model.HDPGMM" title="hdpgmm.model.HDPGMM"><span class="pre">HDPGMM</span></a></span></span><a class="headerlink" href="#hdpgmm.model.variational_inference" title="Permalink to this definition"></a></dt>
<dd><p>infer model parameters through online variational inference (VI)</p>
<p>the routine runs nested iterations for fitting the hierarchical Dirichlet process (HDP) GMM.
after initialization, for every outer loop, the routine first iterates the e-step inner loop
to infer the latent variables for given mini-batch of documents. The inner loop terminates
when the (variational) likelihood of the current mini-batch converges. Then the corpus-level
parameters are updated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> – variable length sequence or bag-of-feature corpus.</p></li>
<li><p><strong>max_components_corpus</strong> – the maximum number of corpus-level, global components</p></li>
<li><p><strong>max_components_document</strong> – the maximum number of document-level components</p></li>
<li><p><strong>n_epochs</strong> – the maximum number of iterations</p></li>
<li><p><strong>batch_size</strong> – the number of samples included in a mini-batch</p></li>
<li><p><strong>kappa</strong> – a parameter controlling the rate of learning rate decay function</p></li>
<li><p><strong>tau0</strong> – a parameter controlling the <cite>offset</cite> of learning rate decay function</p></li>
<li><p><strong>batch_update</strong> – if set True, corpus-level parameters are updated using the sufficient
statistics cumulated from the entire dataset. if set False, it updates
the corpus-level parameters using the local parameter estimation
from the mini-batch, with exponentially decaying <cite>mixing coefficient</cite>
(or <cite>learning rate</cite>).</p></li>
<li><p><strong>m0</strong> – optional global mean prior. if not given, computes the global empirical mean
from the dataset</p></li>
<li><p><strong>W0</strong> – similarly, optional global precision prior.</p></li>
<li><p><strong>nu0</strong> – optional degree of freedom prior</p></li>
<li><p><strong>beta0</strong> – optional precision scale prior</p></li>
<li><p><strong>s1</strong> – prior for the first parameter of the document-level stick</p></li>
<li><p><strong>s2</strong> – prior for the second parameter of the document-level stick</p></li>
<li><p><strong>g1</strong> – prior for the first parameter of the corpus-level stick</p></li>
<li><p><strong>g2</strong> – prior for the second parameter of the corpus-level stick</p></li>
<li><p><strong>n_max_inner_iter</strong> – the maximum number of inner-iteration. Smaller number would
accelerate the training process potentially sacrificing
the likelihood.</p></li>
<li><p><strong>e_step_tol</strong> – the threshold for the termination of the inner loop. The loop ends when
the improvement of likelihood is smaller than the value.</p></li>
<li><p><strong>base_noise_ratio</strong> – controls the amount of the regularization. This algorithm
includes an additional regularization which <cite>splashes</cite> the uniform
random noise to the <cite>responsibility</cite> vector per observation.
the more the noise is added, the stronger the regularization is applied.</p></li>
<li><p><strong>full_uniform_init</strong> – if set True, the parameters are initialized by populating
random responsibilities from the uniform distribution.
if set False, random responsibilities are populated from
random integer (indicator for components), drawn from uniform
categorical distribution with length of <cite>max_components_corpus</cite>.</p></li>
<li><p><strong>share_alpha0</strong> – if set True, the model let the document-level stick shares the single
alpha0. Otherwise, model fits alpha0 per document, which increases the
degree of freedom, while it may let the model overfit.</p></li>
<li><p><strong>data_parallel_num_workers</strong> – set the number of parallel processes for loading
the data using multicores.</p></li>
<li><p><strong>warm_start_with</strong> – if given, the inference routine continues from the point the
<cite>checkpoint</cite> is saved.</p></li>
<li><p><strong>max_len</strong> – as this implementation adopts the masked tensor approach for handling
the variable length data object, it can be extremely inefficient there
is a small number of significantly longer documents. To save memory,
this variable randomly sub-sequences those of documents longer than
the value. It is adjustable for memory efficiency in mind, while it
will affect the inference.</p></li>
<li><p><strong>save_every</strong> – save the checkpoint of the inferred model with this frequency</p></li>
<li><p><strong>out_path</strong> – path where the checkpoints are saved</p></li>
<li><p><strong>prefix</strong> – template (prefix) for the saved checkpoint files</p></li>
<li><p><strong>eps</strong> – small floating point value that is used for the threshold of the termination
of the inner inference iterations</p></li>
<li><p><strong>device</strong> – target computation device {‘cpu’, ‘cuda0’, …}</p></li>
<li><p><strong>verbose</strong> – set verbosity.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>inferred model in the <cite>HDPGMM</cite> dataclass.</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="hdpgmm.math.html" class="btn btn-neutral float-left" title="hdpgmm.math Module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="hdpgmm.parameters.html" class="btn btn-neutral float-right" title="hdpgmm.parameters Module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Jaehun Kim.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>